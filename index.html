<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MedoraX ‚Äî An√°lise Cl√≠nica Inteligente</title>
  <meta name="description" content="MedoraX ‚Äî IA educacional para an√°lise de imagens m√©dicas e pesquisa cl√≠nica com Google CSE e Gemini." />
  <link rel="stylesheet" href="styles.css">
  <!-- Importa√ß√£o da fonte Orbitron para o aspecto futurista -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    /* Pequenas assist√™ncias de estilo local para garantir comportamento m√≠nimo */
    .hidden { display: none !important; }
    #splash-screen{
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, rgba(37,99,235,0.06), rgba(29,78,216,0.04));
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:9999;
      transition: opacity .8s ease, visibility .8s;
    }
    #splash-screen .splash-card{
      text-align:center;
      padding:24px;
      border-radius:12px;
      backdrop-filter: blur(4px);
    }
    .progress-spinner{
      display:inline-block;
      width:18px;
      height:18px;
      border:3px solid rgba(0,0,0,0.1);
      border-top-color: rgba(0,0,0,0.25);
      border-radius:50%;
      animation: spin 1s linear infinite;
      vertical-align:middle;
      margin-right:8px;
    }
    @keyframes spin{ to{ transform: rotate(360deg); } }
  </style>
</head>

<body>
  <!-- SPLASH SCREEN ANIMADA -->
  <div id="splash-screen">
    <div class="splash-card">
      <img src="medorax_logo.png" alt="MedoraX" style="width:64px;height:64px;display:block;margin:0 auto 8px;" />
      <div style="font-weight:700">MedoraX</div>
      <div style="font-size:13px;color:#444;margin-top:6px;">Carregando interface‚Ä¶</div>
      <div style="margin-top:12px;"><span class="progress-spinner"></span> Inicializando</div>
    </div>
  </div>

  <!-- FUNDO ANIMADO (Imagem com anima√ß√£o CSS) -->
  <div class="animated-background" aria-hidden="true"></div>

  <!-- CABE√áALHO -->
  <header>
    <div class="container header-content">
      <div class="logo-area">
        <img id="header-logo" src="medorax_logo.png" alt="MedoraX Logo" class="logo-medorax header-logo" />
        <div>
          <h1 class="project-title">MedoraX</h1>
          <p class="project-subtitle">Assistente Cl√≠nico Inteligente</p>
        </div>
      </div>
      <nav class="main-nav">
        <a href="#about-section">Sobre</a>
        <a href="#upload-section">An√°lise</a>
        <a href="#search-section">Pesquisa</a>
        <a href="#documentation-section">Documenta√ß√£o</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <!-- SE√á√ÉO HERO / APRESENTA√á√ÉO -->
    <section id="about-section" class="hero-section">
      <div class="hero-text">
        <h2>An√°lise M√©dica Inteligente: O Futuro da Cl√≠nica</h2>
        <p class="lead-text">
          O MedoraX √© um sistema de pesquisa e educa√ß√£o que utiliza o poder da Intelig√™ncia Artificial, impulsionado pelo Google Gemini, para realizar a <strong>an√°lise multimodal de imagens m√©dicas</strong> e fornecer <strong>refer√™ncias cl√≠nicas</strong> de alta relev√¢ncia.
        </p>
        <a href="#upload-section" class="btn-primary">
          Iniciar An√°lise Agora
        </a>
      </div>
      <div class="hero-visual">
        <div class="dna-pulse-animation" aria-hidden="true"></div>
      </div>
    </section>

    <!-- SE√á√ÉO DE UPLOAD + RESULTADO -->
    <section id="upload-section" class="main-card-grid">
      <!-- Card Upload -->
      <div class="card upload-card">
        <h3 class="card-title">üì§ Analisar Imagem M√©dica</h3>
        <p class="card-subtitle">Envie uma imagem (PNG/JPG) para an√°lise. O sistema ir√° processar e gerar um relat√≥rio explic√°vel.</p>

        <div id="dropzone" class="dropzone">
          <input id="fileInput" type="file" accept="image/png, image/jpeg" class="hidden" />
          <div class="dropzone-content">
            <div class="icon-dna">üß¨</div>
            <p class="font-medium text-lg">Arraste e solte o arquivo aqui</p>
            <p class="text-sm text-gray-500">ou <span id="pickFile" class="text-primary hover:underline cursor-pointer">clique para selecionar</span></p>
          </div>
        </div>

        <div id="previewContainer" class="hidden preview-container">
          <div class="preview-header">
            <span class="text-sm text-gray-400 font-medium">Pr√©-visualiza√ß√£o</span>
            <button id="clearBtn" class="clear-btn">Limpar</button>
          </div>
          <div class="preview-image-wrapper">
            <img id="previewImg" alt="Pr√©-visualiza√ß√£o" class="preview-img" />
          </div>
        </div>

        <button id="btnAnalyze" class="btn-primary w-full">‚ñ∂Ô∏è Analisar Imagem</button>

        <div id="progress" class="hidden progress-status" style="margin-top:12px;">
          <div class="progress-spinner" aria-hidden="true"></div>
          Processando imagem com Gemini...
        </div>
      </div>

      <!-- Card Resultado -->
      <div class="card result-card">
        <div class="result-header">
          <h3 class="card-title">üß† Resultado da An√°lise</h3>
          <span class="tag">EDUCACIONAL</span>
        </div>

        <div id="resultContainer" class="hidden result-content">
          <div class="result-summary-grid">
            <div class="result-item">
              <p class="result-label">Modalidade</p>
              <p class="result-value" id="modality">‚Äî</p>
            </div>
            <div class="result-item">
              <p class="result-label">Confian√ßa</p>
              <p class="result-value" id="confidence">‚Äî</p>
            </div>
          </div>

          <div class="result-section">
            <h4 class="result-section-title">Achados Cl√≠nicos</h4>
            <ul id="findings" class="result-list"></ul>
          </div>

          <div class="result-section">
            <h4 class="result-section-title">Diagn√≥stico Diferencial (DDx)</h4>
            <ul id="differential" class="result-list"></ul>
          </div>

          <div class="result-section">
            <h4 class="result-section-title">Relat√≥rio Gerado</h4>
            <p id="report" class="report-text"></p>
          </div>

          <div class="result-section">
            <h4 class="result-section-title">Refer√™ncias (Tavily/CSE)</h4>
            <ul id="refs" class="result-list-refs"></ul>
          </div>
        </div>

        <div id="emptyState" class="empty-state">
          Aguardando o envio de uma imagem para an√°lise.
        </div>
      </div>
    </section>

    <!-- SE√á√ÉO DE PESQUISA CL√çNICA -->
    <section id="search-section" class="card search-card">
      <h3 class="card-title">üîç Pesquisa Cl√≠nica Avan√ßada</h3>
      <p class="card-subtitle">Utilize o Google CSE e a Tavily API para buscar artigos e refer√™ncias em fontes m√©dicas confi√°veis.</p>

      <div id="search-form" class="search-form">
        <input id="q" type="text" placeholder="Ex: pneumonia guidelines 2024" class="search-input" />
        <input id="site" type="text" placeholder="Dom√≠nio (opcional, ex: radiopaedia.org)" class="search-input site-input" />
        <input id="num" type="number" min="1" max="10" value="5" placeholder="Qtd" class="search-input num-input" />
        <button id="btnSearch" class="btn-primary search-button">Pesquisar</button>
      </div>

      <div id="searchResults" class="search-results"></div>
    </section>

    <!-- SE√á√ÉO DE DOCUMENTA√á√ÉO T√âCNICA -->
    <section id="documentation-section" class="card documentation-card">
      <h2 class="card-title">Documenta√ß√£o T√©cnica do Projeto</h2>
      <div id="doc-content" class="doc-content">
        <p>Carregando documenta√ß√£o‚Ä¶</p>
      </div>
    </section>
  </main>

  <!-- RODAP√â -->
  <footer>
    <div class="container footer-content">
      <p class="footer-credits">
        Desenvolvido por <a href="https://github.com/ViniciusKhan" target="_blank">Vinicius de Souza Santos</a> | Mestrando em Ci√™ncia da Computa√ß√£o.
      </p>
      <p class="footer-disclaimer">
        ¬© 2025 MedoraX ‚Äî Prot√≥tipo educacional. N√£o utilizar para diagn√≥stico cl√≠nico.
      </p>
    </div>
  </footer>

  <!-- SCRIPT CORRIGIDO E AUTO-CONTIDO -->
  <script>
    // ============================================================
    // üîß Fun√ß√µes auxiliares
    // ============================================================
    function $(id) { return document.getElementById(id); }

    // Fun√ß√£o para converter JSON do Notebook em HTML (aprimorada para Markdown)
    function notebookToHtml(notebookJson) {
        let html = '';
        let notebook;
        try {
            notebook = JSON.parse(notebookJson);
        } catch (e) {
            return `<p class="error-message">Erro ao processar o arquivo do Notebook: ${e.message}</p>`;
        }

        if (!Array.isArray(notebook.cells)) return `<p class="error-message">Notebook inv√°lido</p>`;

        notebook.cells.forEach(cell => {
            if (cell.cell_type === 'markdown') {
                const source = Array.isArray(cell.source) ? cell.source.join('') : (cell.source || '');
                // Convers√£o b√°sica de Markdown para HTML
                let content = source
                    .replace(/^#\s*(.*)$/gm, '<h3>$1</h3>') // H3 para t√≠tulos de se√ß√£o
                    .replace(/^##\s*(.*)$/gm, '<h4>$1</h4>') // H4 para subt√≠tulos
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') // Negrito
                    .replace(/\*(.*?)\*/g, '<em>$1</em>') // It√°lico
                    .replace(/^- (.*)$/gm, '<li>$1</li>') // Lista
                    .replace(/^(<li>.*<\/li>)$/gms, '<ul>$1</ul>') // Envolve a lista
                    .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>'); // Links

                html += `<div class="doc-content-item">${content}</div>`;
            } else if (cell.cell_type === 'code') {
                const source = Array.isArray(cell.source) ? cell.source.join('') : (cell.source || '');
                // Escape HTML entities to display code safely
                const escaped = source
                  .replace(/&/g, '&amp;')
                  .replace(/</g, '&lt;')
                  .replace(/>/g, '&gt;');
                html += `<div class="doc-content-item"><h4>C√≥digo Fonte</h4><pre><code>${escaped}</code></pre></div>`;
            }
        });

        return html;
    }

    // ============================================================
    // üìÅ Seletores principais
    // ============================================================
    const fileInput = $("fileInput");
    const dropzone = $("dropzone");
    const pickFile = $("pickFile");
    const previewContainer = $("previewContainer");
    const previewImg = $("previewImg");
    const clearBtn = $("clearBtn");
    const btnAnalyze = $("btnAnalyze");
    const progress = $("progress");
    const resultContainer = $("resultContainer");
    const emptyState = $("emptyState");
    const docContent = $("doc-content");
    const splashScreen = $("splash-screen");

    // Campos de sa√≠da
    const modality = $("modality");
    const confidence = $("confidence");
    const findingsList = $("findings");
    const diffList = $("differential");
    const report = $("report");
    const refs = $("refs");

    // Campos de pesquisa
    const btnSearch = $("btnSearch");
    const q = $("q");
    const site = $("site");
    const num = $("num");
    const searchResults = $("searchResults");

    // ============================================================
    // üéØ Fun√ß√µes auxiliares
    // ============================================================

    function getBackendBase() {
      return "https://viniciuskhan-backend-medorax.hf.space";
    }

    function showPreview() {
      const file = fileInput && fileInput.files && fileInput.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = (e) => {
        if (previewImg) {
          previewImg.src = e.target.result;
          previewContainer && previewContainer.classList.remove("hidden");
        }
      };
      reader.readAsDataURL(file);
    }

    function updateResultDisplay(data) {
        // Limpa listas
        findingsList && (findingsList.innerHTML = "");
        diffList && (diffList.innerHTML = "");
        refs && (refs.innerHTML = "");

        // Exibe resultados com checagens defensivas
        if (modality) modality.textContent = (data && data.modality) || "N√£o Identificado";
        if (confidence) confidence.textContent =
          data && data.confidence_modality !== undefined
            ? (data.confidence_modality * 100).toFixed(1) + "%"
            : "N/A";

        if (data && data.findings && data.findings.length > 0) {
            findingsList.innerHTML = data.findings
                .map((f) => `<li><strong>${f.name}</strong>: ${f.evidence || "Sem evid√™ncia detalhada"}</li>`)
                .join("");
        } else {
            findingsList && (findingsList.innerHTML = "<li>Nenhum achado cl√≠nico relevante identificado.</li>");
        }

        if (data && data.differential && data.differential.length > 0) {
            diffList.innerHTML = data.differential
                .map(
                    (d) =>
                        `<li>${d.label} ‚Äî <span class="text-gray-500">${(
                            (d.confidence || 0) * 100
                        ).toFixed(0)}%</span></li>`
                )
                .join("");
        } else {
            diffList && (diffList.innerHTML = "<li>Nenhum diagn√≥stico diferencial sugerido.</li>");
        }

        if (report) report.textContent = (data && data.report_text) || "Relat√≥rio n√£o gerado.";

        if (data && data.references && data.references.length > 0) {
            refs.innerHTML = data.references
                .map((r) => `<li><a href="${r.url}" target="_blank" rel="noopener noreferrer">${r.title}</a></li>`)
                .join("");
        } else {
            refs && (refs.innerHTML = "<li>Nenhuma refer√™ncia encontrada.</li>");
        }

        emptyState && emptyState.classList.add("hidden");
        resultContainer && resultContainer.classList.remove("hidden");
        resultContainer && resultContainer.scrollIntoView({ behavior: "smooth" });
    }

    // ============================================================
    // üöÄ Inicializa√ß√£o e Efeitos Visuais
    // ============================================================

    function hideSplashScreen() {
        if (!splashScreen) return;
        setTimeout(() => {
            splashScreen.style.opacity = '0';
            setTimeout(() => {
                splashScreen.style.visibility = 'hidden';
                splashScreen.style.display = 'none';
            }, 900);
        }, 900); // tempo reduzido para demo (adicione mais se quiser)
    }

    // ============================================================
    // üì§ Drag & Drop + upload
    // ============================================================

    if (dropzone) {
      dropzone.addEventListener("click", () => fileInput && fileInput.click());
      dropzone.addEventListener("dragover", (e) => {
          e.preventDefault();
          dropzone.classList.add('dropzone-active');
      });
      dropzone.addEventListener("dragleave", () => {
          dropzone.classList.remove('dropzone-active');
      });
      dropzone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropzone.classList.remove('dropzone-active');
        try {
          // preencher via DataTransfer: compat√≠vel na maioria dos navegadores modernos
          if (e.dataTransfer && e.dataTransfer.files && e.dataTransfer.files.length && fileInput) {
            fileInput.files = e.dataTransfer.files;
            showPreview();
          }
        } catch (err) {
          console.warn("N√£o foi poss√≠vel atribuir arquivos programaticamente.", err);
        }
      });
    }

    if (typeof pickFile !== 'undefined' && pickFile && fileInput) {
      pickFile.addEventListener("click", () => fileInput.click());
    }
    if (fileInput) fileInput.addEventListener("change", showPreview);

    if (clearBtn) clearBtn.addEventListener("click", () => {
      if (fileInput) fileInput.value = "";
      previewContainer && previewContainer.classList.add("hidden");
      resultContainer && resultContainer.classList.add("hidden");
      emptyState && emptyState.classList.remove("hidden");
      searchResults && (searchResults.innerHTML = "");
    });

    // ============================================================
    // üß† An√°lise de imagem
    // ============================================================
    if (btnAnalyze) {
      btnAnalyze.addEventListener("click", async () => {
        const file = fileInput && fileInput.files && fileInput.files[0];
        if (!file) return alert("Selecione uma imagem primeiro.");

        progress && progress.classList.remove("hidden");
        btnAnalyze.disabled = true;
        btnAnalyze.textContent = "‚è≥ Analisando...";

        const formData = new FormData();
        formData.append("image", file);

        try {
          const backendBase = getBackendBase();
          const res = await fetch(`${backendBase}/predict`, {
            method: "POST",
            body: formData,
          });

          if (!res.ok) {
            const text = await res.text();
            throw new Error(`Erro ${res.status}: ${text}`);
          }

          const data = await res.json();
          updateResultDisplay(data);

        } catch (err) {
          alert("‚ùå Erro ao processar imagem: " + err.message);
          console.error(err);
        } finally {
          progress && progress.classList.add("hidden");
          btnAnalyze.disabled = false;
          btnAnalyze.textContent = "‚ñ∂Ô∏è Analisar Imagem";
        }
      });
    }

    // ============================================================
    // üîç Pesquisa cl√≠nica
    // ============================================================
    if (btnSearch) {
      btnSearch.addEventListener("click", async () => {
        const query = q && q.value ? q.value.trim() : "";
        const siteVal = site && site.value ? site.value.trim() : "";
        const numVal = num && num.value ? num.value : 5;

        if (!query) return alert("Digite um termo para pesquisar.");

        if (searchResults) searchResults.innerHTML = "<p class='progress-status'>üîé Buscando...</p>";

        try {
          const backendBase = getBackendBase();
          const url = new URL(`${backendBase}/research`);
          url.searchParams.append("q", query);
          url.searchParams.append("num", numVal);
          if (siteVal) url.searchParams.append("site", siteVal);

          const res = await fetch(url);
          if (!res.ok) throw new Error(`Erro ${res.status}`);

          const data = await res.json();

          if (data.items && data.items.length > 0) {
            searchResults.innerHTML = data.items
              .map(
                (i) =>
                  `<div class="result-item"><a href="${i.url}" target="_blank" rel="noopener noreferrer">${i.title}</a><p>${i.url}</p></div>`
              )
              .join("");
          } else {
            searchResults.innerHTML = "<p class='empty-state'>Nenhum resultado encontrado.</p>";
          }
        } catch (e) {
          if (searchResults) searchResults.innerHTML = `<p class='error-message'>Erro na pesquisa: ${e.message}</p>`;
          console.error(e);
        }
      });
    }

    // ============================================================
    // üìù Inje√ß√£o da Documenta√ß√£o
    // ============================================================

    // Notebook definido como objeto (evita problemas com backticks)
    const notebookObj = {
      nbformat: 4,
      nbformat_minor: 0,
      metadata: {
        kernelspec: { name: "python3", display_name: "Python 3" },
        language_info: { name: "python" }
      },
      cells: [
        {
          cell_type: "markdown",
          source: [
            "# MedoraX: Sistema de An√°lise M√©dica Inteligente\n",
            "\n",
            "## Vis√£o Geral do Projeto\n",
            "\n",
            "O MedoraX √© um projeto de pesquisa e desenvolvimento em Intelig√™ncia Artificial aplicada √† sa√∫de, idealizado por **Vinicius de Souza Santos**, estudante de Mestrado em Ci√™ncias da Computa√ß√£o. O objetivo principal √© criar um assistente educacional e de pesquisa capaz de realizar a **an√°lise multimodal de imagens m√©dicas** e fornecer **refer√™ncias cl√≠nicas** relevantes de forma r√°pida e explic√°vel.\n",
            "\n",
            "O sistema demonstra o potencial da IA na √°rea da sa√∫de, integrando modelos de linguagem avan√ßados com ferramentas de busca especializadas para auxiliar estudantes, pesquisadores e profissionais no processo de interpreta√ß√£o e estudo de casos cl√≠nicos.\n",
            "\n",
            "## Arquitetura e Tecnologias\n",
            "\n",
            "O backend do MedoraX √© uma API robusta e modular, hospedada no Hugging Face Spaces, que orquestra diferentes servi√ßos para entregar a an√°lise completa.\n",
            "\n",
            "### 1. An√°lise Multimodal (Gemini)\n",
            "\n",
            "O cora√ß√£o do sistema √© o modelo **Google Gemini**, utilizado para a an√°lise da imagem m√©dica e a gera√ß√£o do relat√≥rio estruturado. O Gemini √© capaz de processar a imagem (PNG/JPG) e o prompt de instru√ß√£o para extrair informa√ß√µes cruciais como:\n",
            "\n",
            "- **Tipo de Imagem/Modalidade:** Raio-X, Tomografia, Resson√¢ncia, etc.\n",
            "- **Achados Cl√≠nicos:** Descri√ß√£o detalhada das anomalias observadas.\n",
            "- **Diagn√≥stico Diferencial (DDx):** Lista de poss√≠veis diagn√≥sticos com base nos achados.\n",
            "- **Relat√≥rio Explicativo:** Texto coeso e estruturado para o usu√°rio.\n",
            "\n",
            "### 2. Pesquisa Cl√≠nica Avan√ßada (Tavily e Google CSE)\n",
            "\n",
            "Para garantir a relev√¢ncia e a confiabilidade das informa√ß√µes, o MedoraX utiliza ferramentas de busca especializadas:\n",
            "\n",
            "- **Tavily API:** Utilizada para buscar artigos e refer√™ncias em fontes m√©dicas e cient√≠ficas de alta qualidade.\n",
            "- **Google Custom Search Engine (CSE):** Permite a busca em dom√≠nios espec√≠ficos (ex: radiopaedia.org, nejm.org), garantindo que as refer√™ncias sejam de fontes confi√°veis e especializadas.\n",
            "\n",
            "Essas ferramentas s√£o integradas ao fluxo de an√°lise para fornecer refer√™ncias em tempo real, complementando o relat√≥rio gerado pelo Gemini.\n",
            "\n",
            "### 3. API Backend (Hugging Face Spaces)\n",
            "\n",
            "A API √© implementada em Python, utilizando o framework **FastAPI** (ou similar, como Flask/Gradio) para criar dois endpoints principais:\n",
            "\n",
            "- `/predict`: Recebe a imagem e retorna o JSON estruturado da an√°lise do Gemini.\n",
            "- `/research`: Recebe o termo de busca e retorna os resultados da pesquisa cl√≠nica (Tavily/CSE).\n",
            "\n",
            "O link da API √©: https://huggingface.co/spaces/ViniciusKhan/backend-medoraX\n",
            "\n",
            "## C√≥digo de Exemplo (Estrutura da API)\n",
            "\n",
            "Abaixo, um trecho simplificado do c√≥digo que demonstra a integra√ß√£o com o Gemini:\n",
            "\n",
            "```python\nfrom google import genai\nfrom google.genai import types\nfrom PIL import Image\nimport io\n\nclient = genai.Client()\n\ndef analyze_image_with_gemini(image_bytes):\n    img = Image.open(io.BytesIO(image_bytes))\n    prompt = (\n        \"Voc√™ √© um assistente de an√°lise m√©dica. Analise a imagem fornecida e gere um JSON estruturado com os seguintes campos: 'modality', 'confidence_modality', 'findings' (lista de objetos com 'name' e 'evidence'), 'differential' (lista de objetos com 'label' e 'confidence'), e 'report_text'.\"\n    )\n    response = client.models.generate_content(\n        model='gemini-2.5-flash',\n        contents=[prompt, img],\n        config=types.GenerateContentConfig(\n            response_mime_type='application/json'\n        )\n    )\n    return response.text\n```\n",
            "\n",
            "## Contribui√ß√µes e Futuro\n",
            "\n",
            "O MedoraX √© um projeto de c√≥digo aberto focado em pesquisa. Contribui√ß√µes s√£o bem-vindas, especialmente em:\n",
            "\n",
            "- **Otimiza√ß√£o de Prompts:** Melhorar a precis√£o e a estrutura dos relat√≥rios gerados pelo Gemini.\n",
            "- **Integra√ß√£o de Novas APIs:** Adicionar outras fontes de dados e ferramentas de pesquisa.\n",
            "- **Frontend:** Melhorias cont√≠nuas na interface do usu√°rio para uma experi√™ncia mais fluida e intuitiva (como esta que est√° sendo implementada!).\n",
            "\n",
            "Para mais detalhes sobre o desenvolvimento e a pesquisa, consulte o reposit√≥rio completo do projeto.\n"
          ]
        }
      ]
    };

    async function loadDocumentation() {
        if (!docContent) return;
        try {
          docContent.innerHTML = notebookToHtml(JSON.stringify(notebookObj));
        } catch (e) {
          docContent.innerHTML = `<p class="error-message">Erro ao carregar documenta√ß√£o: ${e.message}</p>`;
          console.error(e);
        }
    }

    // ============================================================
    // üèÅ In√≠cio
    // ============================================================
    document.addEventListener("DOMContentLoaded", () => {
        loadDocumentation();
        hideSplashScreen();

        // Navega√ß√£o suave
        document.querySelectorAll('.main-nav a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) target.scrollIntoView({ behavior: 'smooth' });
            });
        });
    });
  </script>
</body>
</html>
